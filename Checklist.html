<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Island Closing Checklist</title>
  <style>
    :root{
      --bg:#f7f7fb; --card:#ffffff; --text:#1f2530; --muted:#5b6577; --accent:#2f6fed; --border:#e4e7ee;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0e1116; --card:#151a22; --text:#e9edf5; --muted:#a7b0c3; --accent:#6da3ff; --border:#263145;
      }
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial}
    header{
      position:sticky;top:0;z-index:10;background:var(--bg);border-bottom:1px solid var(--border);
      padding:10px 16px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between
    }
    .title{font-weight:700}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{
      border:1px solid var(--border);background:var(--card);color:var(--text);
      padding:8px 12px;border-radius:8px;cursor:pointer
    }
    main{max-width:900px;margin:18px auto;padding:0 16px 60px}
    .card{
      background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;margin:12px 0
    }
    h2{margin:0 0 8px 0;font-size:1.1rem}
    details{border-top:1px dashed var(--border);padding-top:8px;margin-top:6px}
    .item{display:flex;gap:10px;align-items:flex-start;padding:10px 8px;border-radius:10px}
    .item:hover{background:rgba(127,127,127,.08)}
    input[type="checkbox"]{width:22px;height:22px;margin-top:2px}
    label{cursor:pointer}
    .muted{color:var(--muted);font-size:.95rem}
    .progress{
      height:10px;background:var(--border);border-radius:999px;overflow:hidden;margin-top:6px
    }
    .bar{height:100%;width:0;background:var(--accent);transition:width .2s}
    .footer-note{margin-top:6px;font-size:.85rem;color:var(--muted)}
    .small{font-size:.95rem}
    .section-header{display:flex;align-items:center;justify-content:space-between;gap:8px}
  </style>
</head>
<body>
<header>
  <div class="title">üèùÔ∏è Island Closing Checklist</div>
  <div class="controls">
    <button id="expandAll">Expand all</button>
    <button id="collapseAll">Collapse all</button>
    <button id="clearAll">Clear checks</button>
    <button onclick="window.print()">Print</button>
  </div>
</header>

<main id="app">
  <!-- Cabin & Grounds -->
  <section class="card" data-section="cabin">
    <div class="section-header">
      <h2>Cabin &amp; Grounds</h2>
      <div class="progress" aria-hidden="true"><div class="bar"></div></div>
    </div>
    <div class="small muted">General shut‚Äëdown tasks around the cabins.</div>
    <div id="cabin-list"></div>
    <div class="footer-note">Note: one interior cabin door has ‚Äúissues.‚Äù Make sure it‚Äôs fully shut.</div>
  </section>

  <!-- Cinderella -->
  <section class="card" data-section="toilet">
    <div class="section-header">
      <h2>Cinderella Incineration Toilet ‚Äî Turn Off &amp; Clean</h2>
      <div class="progress" aria-hidden="true"><div class="bar"></div></div>
    </div>
    <details open>
      <summary class="muted">How‚Äëto steps (tap to toggle)</summary>
      <ol class="small">
        <li><strong>Check for waste:</strong> open lid; confirm bowl is empty of waste/liners.</li>
        <li><strong>Run final burn cycle (if needed):</strong> place a new Cinderella liner, close lid, press <em>Start</em>. Let the cycle finish and cool fully (about 60‚Äì90 min).</li>
        <li><strong>Empty ash:</strong> open front hatch, slide out ash container, empty to trash, wipe with a damp cloth, and reinstall.</li>
        <li><strong>Wipe interior:</strong> lightly wipe bowl and lid with damp cloth or mild soap/water. <em>No bleach or harsh chemicals.</em></li>
        <li><strong>Power off:</strong> switch off the toilet‚Äôs power at its wall switch or breaker.</li>
        <li><strong>Secure:</strong> close lid (latch if present) and ensure the front hatch is fully closed.</li>
      </ol>
    </details>
    <div id="toilet-list"></div>
  </section>

  <!-- Boathouse -->
  <section class="card" data-section="boathouse">
    <div class="section-header">
      <h2>Boathouse (Shore)</h2>
      <div class="progress" aria-hidden="true"><div class="bar"></div></div>
    </div>
    <div id="boathouse-list"></div>
  </section>

  <!-- Exit -->
  <section class="card" data-section="exit">
    <div class="section-header">
      <h2>Exit</h2>
      <div class="progress" aria-hidden="true"><div class="bar"></div></div>
    </div>
    <div id="exit-list"></div>
  </section>
</main>

<script>
/* ----- Checklist data ----- */
const DATA = {
  cabin: [
    "Turn off LP gas tanks and move the middle lever to OFF.",
    "If closing for the season, move LP tanks to the back end of the boathouse (Blue Room).",
    "Put grill gas tank in the shed (grill can stay out).",
    "Push grill to corner by tables (end of season).",
    "Place generator in solar storage under kitchen (if not already there).",
    "Switch inverter to OFF (large switch on back).",
    "Close and lock all cabin windows.",
    "Lower and close blinds.",
    "Lock cabin doors and place rock in front of screen doors for both cabins.",
    "Lock sheds.",
    "Store spare key/boat key in kitchen cabinet.",
    "Take all garbage with you (brown kitchen can empty).",
    "Empty, clean, and turn OFF refrigerator.",
    "Empty Berkey and scrub filters with a scrubbing pad.",
    "Wash all dishes."
  ],
  toilet: [
    "Confirm bowl is empty (no waste or liners).",
    "If needed, run a final burn cycle with a fresh liner and wait until cool.",
    "Empty ash container; wipe and reinstall.",
    "Wipe bowl and lid (damp cloth only; no harsh chemicals).",
    "Turn OFF power at switch/breaker.",
    "Close lid and front hatch; secure."
  ],
  boathouse: [
    "Raise motor (out of water) before using track to avoid catching the cable.",
    "Do not run rack too far out‚Äîonly enough to float boat onto track.",
    "Untie from dock before pulling up on track (avoid dock damage).",
    "Align front pole of track with front hinge of pontoon door.",
    "After boat is in, lower motor inside the metal plate.",
    "Ensure garage door can close; readjust if needed (raise motor when backing out).",
    "Unplug the winch system before leaving."
  ],
  exit: [
    "Use LOW gear for the driveway; steady throttle‚Äîdo not floor it.",
    "Avoid ruts to prevent bouncing and spinning."
  ]
};

/* ----- Render helpers ----- */
const KEY = "islandChecklist_v2";
const app = document.getElementById("app");

function makeId(section, idx){ return `${section}-${idx}`; }

function loadState(){
  try{ return JSON.parse(localStorage.getItem(KEY)) || {}; }
  catch{ return {}; }
}
function saveState(state){ localStorage.setItem(KEY, JSON.stringify(state)); }

function renderSection(section){
  const listEl = document.getElementById(section+"-list");
  const state = loadState();
  const checks = state[section] || {};
  listEl.innerHTML = "";

  DATA[section].forEach((text, i) => {
    const id = makeId(section, i);
    const wrapper = document.createElement("div");
    wrapper.className = "item";
    wrapper.innerHTML = `
      <input type="checkbox" id="${id}" ${checks[id] ? "checked":""} />
      <label for="${id}">${text}</label>
    `;
    listEl.appendChild(wrapper);
  });

  updateProgress(section);
  listEl.addEventListener("change", e => {
    if(e.target.type === "checkbox"){
      const s = loadState();
      s[section] = s[section] || {};
      s[section][e.target.id] = e.target.checked;
      saveState(s);
      updateProgress(section);
    }
  }, { once:true }); // attach once per render
}

function updateProgress(section){
  const card = document.querySelector(`section[data-section="${section}"]`);
  const bar = card.querySelector(".bar");
  const total = DATA[section].length;
  const state = loadState();
  const checked = Object.values(state[section] || {}).filter(Boolean).length;
  const pct = total ? Math.round((checked/total)*100) : 0;
  bar.style.width = pct + "%";
  card.querySelector(".bar").setAttribute("aria-valuenow", pct);
  card.querySelector(".bar").title = pct + "% complete";
}

function renderAll(){
  Object.keys(DATA).forEach(renderSection);
}

/* ----- Controls ----- */
document.getElementById("clearAll").addEventListener("click", () => {
  if(confirm("Clear all checkmarks?")){
    localStorage.removeItem(KEY);
    renderAll();
  }
});
document.getElementById("expandAll").addEventListener("click", () => {
  document.querySelectorAll("details").forEach(d => d.open = true);
});
document.getElementById("collapseAll").addEventListener("click", () => {
  document.querySelectorAll("details").forEach(d => d.open = false);
});

/* ----- Init ----- */
renderAll();
</script>
</body>
</html>
