<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Island Closing & Solar Reference</title>
<style>
  :root{
    --bg:#f7f7fb; --card:#ffffff; --text:#1f2530; --muted:#5b6577; --accent:#2f6fed; --border:#e4e7ee;
  }
  @media (prefers-color-scheme: dark){
    :root{
      --bg:#0e1116; --card:#151a22; --text:#e9edf5; --muted:#a7b0c3; --accent:#6da3ff; --border:#263145;
    }
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  header{
    background:var(--bg);border-bottom:1px solid var(--border);
    padding:10px 16px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between
  }
  .title{font-weight:700}
  nav{display:flex;gap:8px;flex-wrap:wrap}
  nav button{
    border:1px solid var(--border);background:var(--card);color:var(--text);
    padding:6px 12px;border-radius:8px;cursor:pointer
  }
  nav button.active{background:var(--accent);color:#fff}
  main{max-width:900px;margin:18px auto;padding:0 16px 60px}
  .card{
    background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;margin:12px 0
  }
  h2{margin:0 0 8px 0;font-size:1.1rem}
  details{border-top:1px dashed var(--border);padding-top:8px;margin-top:6px}
  .item{display:flex;gap:10px;align-items:flex-start;padding:10px 8px;border-radius:10px}
  input[type="checkbox"]{width:22px;height:22px;margin-top:2px}
  label{cursor:pointer}
  .muted{color:var(--muted);font-size:.95rem}
  .progress{height:10px;background:var(--border);border-radius:999px;overflow:hidden;margin-top:6px}
  .bar{height:100%;width:0;background:var(--accent);transition:width .2s}
  .footer-note{margin-top:6px;font-size:.85rem;color:var(--muted)}
  .small{font-size:.95rem}
  .section-header{display:flex;align-items:center;justify-content:space-between;gap:8px}
  /* Solar Reference page */
  .reference p, .reference li{font-size:0.95rem;margin-bottom:6px}
  .reference h3{margin-top:1em}
</style>
</head>
<body>
<header>
  <div class="title">üèùÔ∏è Island Reference</div>
  <nav>
    <button id="tabChecklist" class="active">Closing Checklist</button>
    <button id="tabReference">Solar Usage Sheet</button>
  </nav>
</header>

<main>
  <!-- Checklist Page -->
  <div id="pageChecklist">
    <!-- Checklist sections are injected here by JS -->
  </div>

  <!-- Solar Reference Page -->
  <div id="pageReference" class="reference" style="display:none;">
    <h2>Cabin Solar Usage Sheet</h2>
    <p><em>Quick reference for what you can safely run with your 24 V lead-acid system.<br>
    (8√ó Kyocera KC175GT panels = 1.4 kW array, OutBack FLEXmax 60 MPPT, 4√ó 6 V batteries in series.)</em></p>
    <h3>System Specs</h3>
    <ul>
      <li>Array: 1,400 W max (8√ó175 W). Typical peak harvest sunny day: 0.8‚Äì1.1 kW.</li>
      <li>Battery bank: 24 V, ~200‚Äì225 Ah ‚Üí 4.8‚Äì5.4 kWh total; usable ~50% = ‚â•2.5 kWh.</li>
      <li>Inverter: ~90% efficiency (‚â•10% losses).</li>
    </ul>
    <h3>Daytime Power Budget (Sunny)</h3>
    <ul>
      <li>While charging at ~500 W ‚Üí ‚â•450 W AC continuous available without lowering SOC.</li>
      <li>Near peak sun (~1.0‚Äì1.2 kW) ‚Üí ‚â•900‚Äì1,050 W AC continuous while still ending full.</li>
      <li>Keep average loads ‚â§ current solar input to avoid pulling from battery.</li>
    </ul>
    <h3>Night / Cloudy Budget (Battery Only)</h3>
    <p>Usable energy = 2.5 kWh before 50% SOC.</p>
    <ul>
      <li>50 W ‚Üí ~50 hrs</li>
      <li>100 W ‚Üí ~25 hrs</li>
      <li>200 W ‚Üí ~12 hrs</li>
      <li>300 W ‚Üí ~8 hrs</li>
      <li>500 W ‚Üí ~5 hrs</li>
    </ul>
    <p><strong>Tip:</strong> Keep average night load ‚â§ 200 W for long battery life.</p>
    <h3>Safe Example Combos (AC, Inverter Losses Included)</h3>
    <ul>
      <li>Mini-fridge (80‚Äì100 W) + 6 LED bulbs (~54 W) + laptop (60 W) + Wi-Fi/router (10 W) ‚Üí ~200‚Äì220 W</li>
      <li>TV 32‚Äì40" (70‚Äì100 W) + fan (40 W) + 4 LEDs (36 W) + phone charging (10‚Äì20 W) ‚Üí ~160‚Äì200 W</li>
      <li>Daytime burst: microwave or power tool (700‚Äì1,200 W) OK short-term if average stays within solar input.</li>
    </ul>
    <h3>Rules of Thumb</h3>
    <ul>
      <li>Keep daytime average AC load ‚â§ solar input (watch OutBack "In" watts).</li>
      <li>Aim to end day at 100% SOC; avoid <50% SOC for lead-acid.</li>
      <li>Float mode limits watts‚Äîlow 'In' with 100% SOC is normal.</li>
      <li>Shade, dirt, or flat tilt reduce harvest‚Äîclean and tilt toward sun.</li>
      <li>Small continuous AC loads can be wasteful; use DC where practical.</li>
    </ul>
    <h3>Battery Care (Lead-acid)</h3>
    <ul>
      <li>Ideal daily depth of discharge: 20‚Äì40% (max ~50%).</li>
      <li>Resting voltage (1‚Äì2 hrs no load/charge): 25.6‚Äì25.8 V (full), 24.4‚Äì24.6 V (‚â•50%), 24.0 V (low‚Äîrecharge soon).</li>
      <li>Check water in flooded cells; keep terminals clean/tight.</li>
    </ul>
  </div>
</main>

<script>
/* Checklist Data */
const DATA = {
  cabin: [
    "Turn off LP gas tanks and move the middle lever to OFF.",
    "If closing for the season, move LP tanks to the back end of the boathouse (Blue Room).",
    "Put grill gas tank in the shed (grill can stay out).",
    "Push grill to corner by tables (end of season).",
    "Place generator in solar storage under kitchen (if not already there).",
    "Switch inverter to OFF (large switch on back).",
    "Close and lock all cabin windows.",
    "Lower and close blinds.",
    "Lock cabin doors and place rock in front of screen doors for both cabins.",
    "Lock sheds.",
    "Store spare key/boat key in kitchen cabinet.",
    "Take all garbage with you (brown kitchen can empty).",
    "Empty, clean, and turn OFF refrigerator.",
    "Empty Berkey and scrub filters with a scrubbing pad.",
    "Wash all dishes."
  ],
  toilet: [
    "Confirm bowl is empty (no waste or liners).",
    "If needed, run a final burn cycle with a fresh liner and wait until cool.",
    "Empty ash container; wipe and reinstall.",
    "Wipe bowl and lid (damp cloth only; no harsh chemicals).",
    "Turn OFF power at switch/breaker.",
    "Close lid and front hatch; secure."
  ],
  boathouse: [
    "Raise motor (out of water) before using track to avoid catching the cable.",
    "Do not run rack too far out‚Äîonly enough to float boat onto track.",
    "Untie from dock before pulling up on track (avoid dock damage).",
    "Align front pole of track with front hinge of pontoon door.",
    "After boat is in, lower motor inside the metal plate.",
    "Ensure garage door can close; readjust if needed (raise motor when backing out).",
    "Unplug the winch system before leaving."
  ],
  exit: [
    "Use LOW gear for the driveway; steady throttle‚Äîdo not floor it.",
    "Avoid ruts to prevent bouncing and spinning."
  ]
};

/* Local Storage */
const KEY = "islandChecklist_v2";
function loadState(){ try{ return JSON.parse(localStorage.getItem(KEY))||{} }catch{return {}} }
function saveState(s){ localStorage.setItem(KEY, JSON.stringify(s)) }
function makeId(sec, i){ return `${sec}-${i}` }

/* Render Checklist */
function renderChecklist(){
  const container = document.getElementById("pageChecklist");
  container.innerHTML = "";
  Object.entries(DATA).forEach(([section, items]) => {
    const secDiv = document.createElement("section");
    secDiv.className = "card";
    secDiv.dataset.section = section;
    secDiv.innerHTML = `
      <div class="section-header">
        <h2>${section==="cabin"?"Cabin & Grounds":
              section==="toilet"?"Cinderella Incineration Toilet":
              section==="boathouse"?"Boathouse (Shore)":"Exit"}</h2>
        <div class="progress"><div class="bar"></div></div>
      </div>
      ${section==="toilet" ? `<details><summary class="muted">How-to steps</summary>
      <ol class="small">
        <li>Check bowl is empty.</li>
        <li>Run final burn cycle if needed; wait until cool.</li>
        <li>Empty ash container, wipe, reinstall.</li>
        <li>Wipe interior (no harsh chemicals).</li>
        <li>Turn off power at breaker/switch.</li>
        <li>Close lid and front hatch securely.</li>
      </ol></details>` : ""}
      <div id="${section}-list"></div>
    `;
    container.appendChild(secDiv);
    renderSection(section);
  });
}

function renderSection(section){
  const listEl = document.getElementById(section+"-list");
  const state = loadState();
  const checks = state[section] || {};
  listEl.innerHTML = "";
  DATA[section].forEach((text,i)=>{
    const id = makeId(section,i);
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `<input type="checkbox" id="${id}" ${checks[id]?"checked":""} />
                     <label for="${id}">${text}</label>`;
    listEl.appendChild(div);
  });
  listEl.addEventListener("change", e=>{
    if(e.target.type==="checkbox"){
      const s=loadState();
      s[section]=s[section]||{};
      s[section][e.target.id]=e.target.checked;
      saveState(s);
      updateProgress(section);
    }
  });
  updateProgress(section);
}

function updateProgress(section){
  const sec = document.querySelector(`section[data-section="${section}"]`);
  const total = DATA[section].length;
  const checked = Object.values(loadState()[section]||{}).filter(Boolean).length;
  sec.querySelector(".bar").style.width = (total?checked/total*100:0)+"%";
}

/* Tab Switching */
document.getElementById("tabChecklist").addEventListener("click",()=>{
  document.getElementById("pageChecklist").style.display="";
  document.getElementById("pageReference").style.display="none";
  document.getElementById("tabChecklist").classList.add("active");
  document.getElementById("tabReference").classList.remove("active");
});
document.getElementById("tabReference").addEventListener("click",()=>{
  document.getElementById("pageChecklist").style.display="none";
  document.getElementById("pageReference").style.display="";
  document.getElementById("tabReference").classList.add("active");
  document.getElementById("tabChecklist").classList.remove("active");
});

/* Init */
renderChecklist();
</script>
</body>
</html>